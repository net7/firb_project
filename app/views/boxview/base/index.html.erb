<html>
  <head>
    <title>Boxview | <%= TaliaCore::CONFIG['site_name'] %></title>
    <link href="/stylesheets/frontend-boxview/firb-common.css" media="screen" type="text/css" rel="stylesheet"/>
    <link href="/stylesheets/frontend-boxview/<%= TaliaCore::CONFIG['firb']['theme'] || 'pi'%>/firb.css" media="screen" type="text/css" rel="stylesheet"/>
    <link href="http://fonts.googleapis.com/css?family=OFL+Sorts+Mill+Goudy+TT" rel="stylesheet" type="text/css"/>
  </head>
  <body>

    <div style="display: none;" id="loadingDialog">
      <!-- FIXME -->
      <!-- <img src="css/images/loader/ajax_loader.gif" alt="Caricamento in corso"/> -->
      <p>Caricamento in corso</p>
    </div>  
  
    <div id="pageExt">
      <div id="pageHeader">
        <h1><%= TaliaCore::CONFIG['site_name'] %></h1>
        <p><%= TaliaCore::CONFIG['firb']['site_subtitle'] %></p>
        <div id="header_preferences_wrapper">
          <div id="header_preferences">
            <ul>
              <li><a href="boxViewer.php?method=getIntro" id="pref_intro" title="Introduzione">Introduzione</a></li>
              <li><a href="boxViewer.php?method=getAiuto" id="pref_help" title="Help">Help</a></li>
              <li><a href="#" id="pref_history" title="Check your navigation history!">History</a></li>
              <li><a href="#" id="pref_link" title="Copia il link a questa pagina">Link</a></li>
              <li><a href="boxViewer.php?method=getMyDoni" id="pref_notebooks" title="Notebook personali">Notebooks</a></li>
              <li><a href="#" id="pref_settings" title="Modifica le tue preferenze">Preferenze</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div id="pageContent">
        <a id="indice_indici" href="#">Indice degli indici</a>
        <a id="indice_pi" href="#">Indice PISA</a>
      </div>
    </div>
    <script src="/_boxview/src/tools.js"></script>
    <script>
      var bs = new BoxStrapper('../_boxview/', '../boxview_config.js');
      function onInitDone() {
        // Sets boxview's height to match the height of the page.
        $('#pageContent').height(($(window).height() - $('#pageHeader').height() - 1));
        $(window).resize(function(){
          $('#pageContent').height(($(window).height() - $('#pageHeader').height() - 1));
        });

        <%= boxview_link_code %>

  
        $("#indice_indici").click(function(e){
          e.preventDefault();
          myBoxView.addBoxFromAjax(
            {qstring: '<%= url_for(:controller => "boxview/indici") %>',
             title: 'Indice: indici!!', 
             verticalTitle: 'Indice: indici!!',
             resId: 'indexes_index',
             type: 'index',
             collapsed: false}
          );
        });

        $("#indice_pi").click(function(e){
          e.preventDefault();
          myBoxView.addBoxFromAjax(
            {qstring: '<%= url_for(:controller => "boxview/indici/pi") %>',
             title: 'Indice: Memorie Pisa', 
             verticalTitle: 'Indice: Memorie Pisa',
             resId: 'index_memorie',
             type: 'index',
             collapsed: false}
          );
        });

	    //myBoxView.openHistoryBox();
      }

      function getFlashObject(movieName) {
        if (navigator.appName.indexOf("Microsoft") != -1) {
        return window[movieName];
        } else {
          var obj = document[movieName];
          if (obj.length != 'undefined') {
            for(var i=0;i<obj.length;i++) { 
              if(obj[i].tagName.toLowerCase() == 'embed') return obj[i]; 
            }
          }
          return obj;
         }
       }

      // Initialization: IMT will call this when it's ready to load an image
      function jsapi_initializeIMW(id) {
        var new_b64;
        if (navigator.appName.indexOf("Microsoft") != -1) new_b64 = $("#"+id).attr('b64');
        else new_b64 = $('#'+id+" embed").attr('b64');
        getFlashObject(id).initialize(new_b64, 2);
      } // jsapi_initializeIMW()

      function jsapi_mouseOver(fid, ki) {	
        $("#image_zone_"+ki).toggleClass('highlighted');
      }

      function jsapi_mouseOut(fid, ki) {
        $("#image_zone_"+ki).toggleClass('highlighted');
      }

      function jsapi_mouseClick(fid, ki) {}
    </script>
  </body>
</html>
